# π¤– λ‚λ§μ LLM μ„λΉ„μ¤ κ²½λ‰ν™” ν”„λ΅μ νΈ

## κ°μ”
μ΄λ² ν”„λ΅μ νΈλ” LLM(λ€ν• μ–Έμ–΄ λ¨λΈ) μ„λΉ„μ¤μ ν•™μµ μ†λ„λ¥Ό λ†’μ΄κ³  λ©”λ¨λ¦¬ ν¨μ¨μ„±μ„ κ°μ„ ν•κΈ° μ„ν•΄ **κ²½λ‰ν™” κΈ°λ²•**μ„ μ μ©ν• μ‹¤ν—μ…λ‹λ‹¤.  
**7μ£Όμ°¨μ— κ°λ°ν• λ¨λΈμ€ μ£Όλ΅ ν”„λ΅¬ν”„νΈ κΈ°λ°μ΄μ–΄μ„ κ²½λ‰ν™” ν¨κ³Όλ¥Ό μ λ€λ΅ μ²΄κ°ν•κΈ° μ–΄λ ¤μΈ κ²ƒμΌλ΅ νλ‹¨ν•μ—¬, λ€μ‹  6μ£Όμ°¨μ— μ‚¬μ©λ ν•™μµ λ¨λΈμ„ μ‚¬μ©ν•μ—¬ μ§„ν–‰ν•μ€μµλ‹λ‹¤.** ν•™μµ λ°μ΄ν„°λ” `corpus.json`μ— μ €μ¥λμ–΄ μμµλ‹λ‹¤.

## π“‚ μ£Όμ” νμΌ μ„¤λ…

μ΄ 4κ°μ Python νμΌλ΅ μ‹¤ν—μ„ κµ¬μ„±ν–μµλ‹λ‹¤.

- `before_small.py` : κ²½λ‰ν™” μ μ© μ „, `facebook/opt-350m` λ¨λΈμ„ μ‚¬μ©ν• μ½”λ“
- `lightweight_small.py` : κ²½λ‰ν™” μ μ© ν›„, `facebook/opt-350m` λ¨λΈμ„ μ‚¬μ©ν• μ½”λ“
- `before_big.py` : κ²½λ‰ν™” μ μ© μ „, `EleutherAI/gpt-neo-1.3B` λ¨λΈμ„ μ‚¬μ©ν• μ½”λ“
- `lightweight_big.py` : κ²½λ‰ν™” μ μ© ν›„, `EleutherAI/gpt-neo-1.3B` λ¨λΈμ„ μ‚¬μ©ν• μ½”λ“

`before` νμΌλ“¤μ€ κ²½λ‰ν™” μ μ© μ „ μƒνƒλ¥Ό, `lightweight` νμΌλ“¤μ€ κ²½λ‰ν™”λ¥Ό μ μ©ν• μƒνƒλ¥Ό μλ―Έν•©λ‹λ‹¤. `small` νμΌλ“¤μ€ μ‘μ€ λ¨λΈ(`350M`)μ„, `big` νμΌλ“¤μ€ ν° λ¨λΈ(`1.3B`)μ„ μ‚¬μ©ν•μ—¬ μ‹¤ν—ν–μµλ‹λ‹¤.

## π§ μ‹¤ν— κ³Όμ • λ° κ²°κ³Ό

### 1. μ‘μ€ λ¨λΈ μ‹¤ν— (`facebook/opt-350m`)

μ‘μ€ λ¨λΈ(`350M`)μ„ μ‚¬μ©ν•΄ κ²½λ‰ν™”μ ν¨κ³Όλ¥Ό λ¨Όμ € μ‹¤ν—ν–μµλ‹λ‹¤. `before_small.py`μ™€ `lightweight_small.py`λ¥Ό κ°κ° μ‹¤ν–‰ν•μ—¬ ν•™μµ μ‹κ°„μ„ λΉ„κµν•΄λ³΄μ•μµλ‹λ‹¤.

- **κ²½λ‰ν™” μ „ ν•™μµ μ‹κ°„** : 2.67λ¶„  
  ![image](https://github.com/user-attachments/assets/8965bcb3-a7a7-44e0-aba5-139233f55fa2)

- **κ²½λ‰ν™” ν›„ ν•™μµ μ‹κ°„** : 0.72λ¶„ (μ•½ 3λ°° μ†λ„ ν–¥μƒ π€)  
  ![image](https://github.com/user-attachments/assets/ec223c43-d8b2-42dc-8c36-ef62d5802be1)

κ²½λ‰ν™”λ¥Ό ν†µν•΄ **ν•™μµ μ†λ„κ°€ μ•½ 3λ°° λΉ¨λΌμ΅μΌλ©°**, `train/loss` κ·Έλν”„λ¥Ό ν†µν•΄ ν•™μµ μ†μ‹¤μ΄ μ•μ •μ μΌλ΅ κ°μ†ν•λ” κ²ƒμ„ ν™•μΈν–μµλ‹λ‹¤. μ„±λ¥ μ €ν• μ—†μ΄ μ†λ„λ¥Ό ν¬κ² κ°μ„ ν• κ²°κ³Όμ…λ‹λ‹¤.  

λν• κ²½λ‰ν™” μ „ν›„ λ¨λ‘ μ•μ •μ μΌλ΅ `loss`κ°€ μ¤„μ–΄λ“λ” λ¨μµμ΄ κ΄€μ°°λμ—μµλ‹λ‹¤.

- **κ²½λ‰ν™” μ „ Loss κ°μ† μ¶”μ΄**:  
  ![image](https://github.com/user-attachments/assets/e1373019-e4c0-4ab7-abea-efab81687385)

- **κ²½λ‰ν™” ν›„ Loss κ°μ† μ¶”μ΄**:  
  ![image](https://github.com/user-attachments/assets/554b59eb-684c-41b5-9d70-219d9321151d)

### 2. ν° λ¨λΈ μ‹¤ν— (`EleutherAI/gpt-neo-1.3B`)

λ” ν° λ¨λΈμΈ `1.3B` νλΌλ―Έν„° λ¨λΈλ΅ μ‹¤ν—μ„ μ§„ν–‰ν–μµλ‹λ‹¤. κ²½λ‰ν™” μ μ© μ „ νμΌ(`before_big.py`)μ„ μ‹¤ν–‰ν•λ ¤ ν–μΌλ‚, **CUDA λ©”λ¨λ¦¬ λ¶€μ΅± μ—λ¬**κ°€ λ°μƒν•΄ ν•™μµμ΄ λ¶κ°€λ¥ν–μµλ‹λ‹¤.  
![image](https://github.com/user-attachments/assets/eafb76a7-8fd6-4ada-9eb7-4a3e1dd757c9)

μ΄λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄ `lightweight_big.py`μ—μ„λ” κ²½λ‰ν™” κΈ°λ²•μ„ μ μ©ν•μ—¬ GPU λ©”λ¨λ¦¬λ¥Ό ν¨μ¨μ μΌλ΅ μ‚¬μ©ν•λ„λ΅ λ³€κ²½ν–μµλ‹λ‹¤.

#### κ²½λ‰ν™” μ μ© λ°©μ‹
- **4λΉ„νΈ μ–‘μν™”** : λ¨λΈ νλΌλ―Έν„°λ¥Ό 4λΉ„νΈλ΅ μ¤„μ—¬ λ©”λ¨λ¦¬ μ‚¬μ©λ‰ κ°μ†
- **LoRA (Low-Rank Adaptation)** : λ¨λΈμ μΌλ¶€ λ¨λ“μ—λ§ ν•™μµ κ°€λ¥ν• νλΌλ―Έν„°λ¥Ό μ¶”κ°€ν•μ—¬ κ²½λ‰ν™”

κ²½λ‰ν™”λ¥Ό ν†µν•΄ ν•™μµμ„ μ„±κ³µμ μΌλ΅ μ‹¤ν–‰ν•  μ μμ—μΌλ©°, μ΄λ¥Ό ν†µν•΄ λ©”λ¨λ¦¬ ν¨μ¨μ„±μ μ΄μ μ„ ν™•μΈν–μµλ‹λ‹¤.  
![image](https://github.com/user-attachments/assets/1375ea42-d610-41ac-ba0d-1e462459bd49)


## π’΅ μ–»μ€ μ΄μ 
κ²½λ‰ν™” κΈ°λ²•μ„ ν†µν•΄ λ‹¤μκ³Ό κ°™μ€ μ΄μ μ„ μ–»μ„ μ μμ—μµλ‹λ‹¤.

1. **ν•™μµ μ†λ„ κ°μ„ ** : μ‘μ€ λ¨λΈ(`350M`)μ—μ„ κ²½λ‰ν™” ν›„ μ•½ 3λ°° λΉ λ¥Έ ν•™μµ μ†λ„λ¥Ό ν™•μΈν–μµλ‹λ‹¤.
2. **λ©”λ¨λ¦¬ ν¨μ¨μ„± ν–¥μƒ** : ν° λ¨λΈ(`1.3B`)μ€ κ²½λ‰ν™” μ—†μ΄λ” μ‹¤ν–‰μ΄ λ¶κ°€λ¥ν–μΌλ‚, μ–‘μν™”μ™€ LoRA κΈ°λ²•μ„ ν†µν•΄ λ©”λ¨λ¦¬ μ ν• λ¬Έμ λ¥Ό ν•΄κ²°ν–μµλ‹λ‹¤.

μ΄μ™€ κ°™μ€ κ²°κ³Όλ¥Ό ν†µν•΄ **κ²½λ‰ν™” κΈ°λ²•**μ΄ λ€ν• λ¨λΈ ν•™μµμ— ν•„μμ μ΄λΌλ” μ μ„ μ‹¤κ°ν•  μ μμ—μµλ‹λ‹¤. νΉν, μ ν•λ ν•λ“μ›¨μ–΄ ν™κ²½μ—μ„ λ” ν° λ¨λΈμ„ μ‚¬μ©ν•  μ μλ” κ°€λ¥μ„±μ„ λ³΄μ—¬μ¤¬μµλ‹λ‹¤.
